Я решил повторить пример из habr, который вы нам прислали. Но, как выяснилось, работать в spark-shell не очень удобно. Потому что даже на том примере из habr можно визуализировать распределение покупателей по возрасту в виде графика (вторая картинка). И вывод не съезжает (первая картинка).
Поэтому решил, что сделаю другое дз.

```scala
val raw = spark
              .read
              .option("header", "true")
              .option("inferSchema", "true")
              .csv(s"/home/ilya/Activities/Studying/Аспирантура/2_год/BIGDATA/HW4")
val columns: Array[String] = raw.columns
val columnsLen: Int = columns.length
val colsToDrop: Array[String] = columns.slice(columnsLen - 2, columnsLen) :+ columns.head
```

![[Pasted image 20230602192759.png]]
![[Pasted image 20230602192848.png]]
![[Pasted image 20230602193652.png]]